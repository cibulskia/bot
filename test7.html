<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Category Manager (Demo)</title>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<style>
  /* ... (isti CSS kod) ... */
</style>
</head>
<body>
<div id="g_id_onload" data-client_id="252373158568-4up41b7jo8ik6cu8c1pl3mlvvck2sq2t.apps.googleusercontent.com" data-callback="handleCredentialResponse" data-auto_select="true" data-ux_mode="popup"></div>

<!-- Premesti handleCredentialResponse direktno ovde, pre ucitavanja ostalih skripti -->
<script>
  let googleToken = null; // Deklarisi googleToken globalno ovde ili ga prosledi

  window.handleCredentialResponse = (response) => {
    if (response && response.credential) {
      googleToken = response.credential;
      document.getElementById("loginStatus").textContent = "Ulogovan (token primljen).";
      document.getElementById("signOutBtn").style.display = "inline-block";
      console.log("Google token received.");
    } else {
      document.getElementById("loginStatus").textContent = "Prijava nije uspela.";
    }
  };
</script>

<div class="box">
  <h2>Prijava</h2>
  <p id="loginStatus">Čekam Google prijavu...</p>
  <button id="signOutBtn" style="display:none" class="secondary">Odjavi se</button>
</div>

<div class="box">
  <h2>Korisnicka podesavanja</h2>
  <div class="row">
    <div class="col" id="cat_cb_container">
      <label><input type="checkbox" id="cat_cb1"> proizvodjac</label>
      <label><input type="checkbox" id="cat_cb2"> poslodavac</label>
    </div>
    <div class="col">
      <label>vrsta obrade:
        <select id="cat_dropdown">
          <option value="">-- izaberi --</option>
          <option value="opt1">strug</option>
          <option value="opt2">glodalica</option>
          <option value="opt3">strug i glodalica</option>
        </select>
      </label>
      <label>ime firme: <input type="text" id="cat_text1" placeholder="Unesite ime firme"></label>
      <label>opis firme: <textarea id="cat_text2" placeholder="Unesite opis firme"></textarea></label>
      <label>email: <input type="text" id="cat_text3" placeholder="Unesite email"></label>
      <label>internet stranica: <input type="text" id="cat_text4" placeholder="Unesite internet stranicu"></label>
    </div>
  </div>
  <div style="margin-top:12px;">
    <button id="btnLoadCategory">Učitaj podesavanja</button>
    <button id="btnUpdateCategory">Sačuvaj / Ažuriraj podesavanja</button>
    <button id="btnDeleteCategory" class="danger">Obriši nalog</button>
  </div>
  <div class="status" id="catStatus"></div>
</div>

<div class="box">
  <h2>Ponuda poslova</h2>
  <div class="row">
    <div style="width:280px;">
      <div style="display:flex; gap:8px; margin-bottom:8px;">
        <button id="btnListSubcats">Lista ponuda</button>
      </div>
      <div class="subcat-list" id="subcatList"></div>
    </div>
    <div style="flex:1;">
      <h3 id="subcatEditorTitle">Nije izabrana lista ponuda</h3>
      <label>posao: <input type="text" id="sub_name" disabled></label>
      <label>kratak opis: <input type="text" id="sub_text1" disabled></label>
      <label>objasnjenje: <textarea id="sub_text2" disabled></textarea></label>
      <label>rok za ponudu: <input type="text" id="sub_text3" disabled></label>
      <label>rok za izradu: <input type="text" id="sub_text4" disabled></label>
      <label><input type="checkbox" id="sub_cb1">prijavljujem se za posao</label>
      <div style="margin-top:8px;">
        <button id="btnUpdateSubcat">posalji prijavu</button>
      </div>
      <div class="status" id="subStatus"></div>
    </div>
  </div>
</div>

<script src="oauth.js"></script> <!-- oauth.js sada moze da koristi googleToken i druge globalne stvari -->
<script src="backend.js"></script>
</body>
</html>
